{% extends 'templates/base.html' %}

{% block content %}
<!-- Contenido principal -->
<main class="flex-1 p-6 overflow-auto w-full transition-all duration-300">

  <!-- Encabezado -->
  <h1 class="text-2xl font-bold mb-6">Resumen Financiero</h1>

  <!-- Tarjetas -->
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
    
    <!-- Total Gastos -->
    <div class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold text-gray-700">Gastos</h2>
      <p class="text-3xl font-bold text-gray-800">
        ${{ total_gastos|floatformat:2 }}
      </p>
    </div>

    <!-- Total Ingresos -->
    <div class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold text-gray-700">Ingresos</h2>
      <p class="text-3xl font-bold text-gray-800">
        ${{ total_ingresos|floatformat:2 }}
      </p>
    </div>

    <!-- Balance -->
    <div class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold text-gray-700">Balance</h2>
      <p class="text-3xl font-bold text-gray-800">
        ${{ balance|floatformat:2 }}
      </p>
    </div>
  </div>

  <!-- Tablas -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
    
    <!-- Últimos Gastos -->
    <div class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold text-gray-700 mb-4">Últimos Gastos</h2>
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Fecha</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Categoría</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Monto</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          {% for gasto in gastos %}
          <tr>
            <td class="px-4 py-2 text-sm text-gray-700">{{ gasto.fecha }}</td>
            <td class="px-4 py-2 text-sm text-gray-700">{{ gasto.categoria }}</td>
            <td class="px-4 py-2 text-sm text-gray-700">${{ gasto.monto|floatformat:2 }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="3" class="px-4 py-2 text-center text-sm text-gray-500">No hay gastos recientes</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Últimos Ingresos -->
    <div class="bg-white p-6 rounded-2xl shadow-md">
      <h2 class="text-lg font-semibold text-gray-700 mb-4">Últimos Ingresos</h2>
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-gray-50">
          <tr>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Fecha</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Fuente</th>
            <th class="px-4 py-2 text-left text-sm font-medium text-gray-500">Monto</th>
          </tr>
        </thead>
        <tbody class="divide-y divide-gray-200">
          {% for ingreso in ingresos %}
          <tr>
            <td class="px-4 py-2 text-sm text-gray-700">{{ ingreso.fecha }}</td>
            <td class="px-4 py-2 text-sm text-gray-700">{{ ingreso.fuente }}</td>
            <td class="px-4 py-2 text-sm text-gray-700">${{ ingreso.monto|floatformat:2 }}</td>
          </tr>
          {% empty %}
          <tr>
            <td colspan="3" class="px-4 py-2 text-center text-sm text-gray-500">No hay ingresos recientes</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <!-- Distribución de Gastos -->
  <div class="bg-white p-6 rounded-2xl shadow-md">
    <h2 class="text-lg font-semibold text-gray-700 mb-4">Distribución de Gastos</h2>
    <div class="space-y-4">
      {% for cat in categorias %}
      <div>
        <div class="flex justify-between mb-1">
          <span class="text-sm font-medium text-gray-700">{{ cat.categoria }}</span>
          <span class="text-sm text-gray-500">{{ cat.porcentaje }}%</span>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
          <div class="bg-red-500 h-2 rounded-full" style="width: {{ cat.porcentaje }}%"></div>
        </div>
      </div>
      {% empty %}
      <p class="text-gray-500 text-sm">No hay datos de categorías</p>
      {% endfor %}
    </div>
  </div>

</main>
{% endblock %}
